# FirmOS QC Workflow State Machine
# Defines the quality control review process

version: "1.0"
updated: "2026-02-03"

# ============================================================================
# WORKFLOW STATES
# ============================================================================
states:
  DRAFT:
    description: "Work in progress by preparer"
    allowed_transitions:
      - PENDING
    owner: preparer
    
  PENDING:
    description: "Submitted for QC review"
    allowed_transitions:
      - IN_REVIEW
    owner: system
    
  IN_REVIEW:
    description: "Currently being reviewed by Diane"
    allowed_transitions:
      - PASS
      - PASS_WITH_COMMENTS
      - REVISE
      - ESCALATE
    owner: diane
    
  PASS:
    description: "Approved for release"
    allowed_transitions:
      - RELEASED
    owner: diane
    icon: "‚úÖ"
    
  PASS_WITH_COMMENTS:
    description: "Approved with minor comments noted"
    allowed_transitions:
      - RELEASED
    owner: diane
    icon: "üìù"
    
  REVISE:
    description: "Returned to preparer for corrections"
    allowed_transitions:
      - PENDING  # Re-submit after revision
    owner: preparer
    icon: "üîÑ"
    
  ESCALATE:
    description: "Escalated to governance for review"
    allowed_transitions:
      - PASS
      - REVISE
    owner: marco
    icon: "‚ö†Ô∏è"
    
  RELEASED:
    description: "Approved and released to client"
    allowed_transitions: []  # Terminal state
    owner: system
    icon: "üöÄ"

# ============================================================================
# WORKFLOW ACTIONS
# ============================================================================
actions:
  submit_for_review:
    from: DRAFT
    to: PENDING
    actor: preparer
    required_fields:
      - deliverable_type
      - entity_id
      - period
      - description
      
  approve:
    from: IN_REVIEW
    to: PASS
    actor: diane
    required_fields:
      - review_notes
      
  approve_with_comments:
    from: IN_REVIEW
    to: PASS_WITH_COMMENTS
    actor: diane
    required_fields:
      - review_notes
      - comments
      
  reject:
    from: IN_REVIEW
    to: REVISE
    actor: diane
    required_fields:
      - review_notes
      - revision_required
      
  escalate:
    from: IN_REVIEW
    to: ESCALATE
    actor: diane
    required_fields:
      - escalation_reason
      - risk_assessment

# ============================================================================
# SLA DEFINITIONS
# ============================================================================
sla:
  urgent:
    review_time: 4  # hours
  standard:
    review_time: 24  # hours
  routine:
    review_time: 48  # hours
